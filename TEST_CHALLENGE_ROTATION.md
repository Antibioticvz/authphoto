# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Challenge Auto-Rotation

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞

- `nextChallenge` –±—ã–ª –≤ `useState`, —á—Ç–æ —Å–æ–∑–¥–∞–≤–∞–ª–æ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏
- –ü—Ä–∏ —Ä–æ—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ closure

### –†–µ—à–µ–Ω–∏–µ

- –ó–∞–º–µ–Ω–∏–ª `useState` –Ω–∞ `useRef` –¥–ª—è `nextChallenge`
- –¢–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `nextChallengeRef.current`

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –±—ç–∫–µ–Ω–¥

```bash
# Terminal 1 - Backend
cd backend
npm run dev

# Terminal 2 - Frontend
cd frontend
npm run dev -- --host
```

### 2. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–û—Ç–∫—Ä–æ–π—Ç–µ `https://localhost:5173` (–∏–ª–∏ –≤–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π IP)

### 3. –ß—Ç–æ –Ω–∞–±–ª—é–¥–∞—Ç—å

#### –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:

```
‚úÖ Set current challenge: [UUID]
‚è∞ Challenge TTL: 30s
```

#### –ß–µ—Ä–µ–∑ ~20 —Å–µ–∫—É–Ω–¥:

```
üîÑ Preloading next challenge...
üîÑ Preloaded next challenge: [UUID-2]
```

#### –ß–µ—Ä–µ–∑ ~25 —Å–µ–∫—É–Ω–¥:

- Countdown —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–∂–µ–ª—Ç—ã–º**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "‚ö†Ô∏è Challenge expiring soon!"
- –ö–Ω–æ–ø–∫–∞ **Capture –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è**

#### –ß–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ (—Ä–æ—Ç–∞—Ü–∏—è):

```
üîÑ Rotating to next challenge...
‚úÖ Using preloaded challenge: [UUID-2]
‚è∞ Challenge TTL: 30s
üîÑ Preloading next challenge...
```

- Challenge **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** –º–µ–Ω—è–µ—Ç—Å—è
- Countdown **reset** –Ω–∞ 30s
- –ö–Ω–æ–ø–∫–∞ **—Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è**
- –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

### 4. UI —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

#### Countdown —Ç–∞–π–º–µ—Ä

- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (30, 29, 28...)
- ‚úÖ –ú–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç –ø—Ä–∏ <= 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

#### –ö–Ω–æ–ø–∫–∞ Capture

- ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞ –ø—Ä–∏ timeRemaining > 5
- ‚úÖ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ timeRemaining <= 5
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "Capture blocked"

#### Console –ª–æ–≥–∏

```
‚è∞ Challenge TTL: 30s          // –ù–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
üîÑ Preloading next challenge... // –ó–∞ 10s –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
üîÑ Rotating to next challenge... // –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏
‚úÖ Using preloaded challenge    // –£—Å–ø–µ—à–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è
```

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### Challenge –Ω–µ —Ä–æ—Ç–∏—Ä—É–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**

- Console - –µ—Å—Ç—å –ª–∏ –ª–æ–≥–∏ preload –∏ rotation?
- Network - –ø—Ä–∏—Ö–æ–¥—è—Ç –ª–∏ –Ω–æ–≤—ã–µ challenge —Å –±—ç–∫–µ–Ω–¥–∞?
- –¢–∞–π–º–µ—Ä—ã - –æ—á–∏—â–∞—é—Ç—Å—è –ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?

### –ö–Ω–æ–ø–∫–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**

- `isNearExpiry` –≤ console
- `timeRemaining` –∑–Ω–∞—á–µ–Ω–∏–µ
- –õ–æ–≥–∏–∫–∞ –≤ App.tsx `disabled={... || isNearExpiry}`

### Countdown –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**

- –ò–Ω—Ç–µ—Ä–≤–∞–ª –≤ `setupRotation`
- `setTimeRemaining` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É?
- useEffect cleanup –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

## üìä –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

| –í—Ä–µ–º—è | Countdown   | isNearExpiry | –ö–Ω–æ–ø–∫–∞           | –¶–≤–µ—Ç UI    |
| ----- | ----------- | ------------ | ---------------- | ---------- |
| 0s    | 30s         | false        | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞       | üü¶ –ì–æ–ª—É–±–æ–π |
| 10s   | 20s         | false        | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞       | üü¶ –ì–æ–ª—É–±–æ–π |
| 20s   | 10s         | false        | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞       | üü¶ –ì–æ–ª—É–±–æ–π |
| 25s   | 5s          | true         | üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ | üü® –ñ–µ–ª—Ç—ã–π  |
| 29s   | 1s          | true         | üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ | üü® –ñ–µ–ª—Ç—ã–π  |
| 30s   | 30s (reset) | false        | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞       | üü¶ –ì–æ–ª—É–±–æ–π |

## ‚ú® –£—Å–ø–µ—à–Ω—ã–π —Ç–µ—Å—Ç

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

1. ‚úÖ Challenge –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–æ—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 30s
2. ‚úÖ –ù–µ—Ç –≤–∏–¥–∏–º–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ —Ä–æ—Ç–∞—Ü–∏–∏
3. ‚úÖ Preload –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞ 10s –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
4. ‚úÖ –ö–Ω–æ–ø–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∑–∞ 5s –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
5. ‚úÖ Countdown –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ
6. ‚úÖ UI –º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç –ø—Ä–∏ near expiry
7. ‚úÖ Console –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –ª–æ–≥–∏ —Ä–æ—Ç–∞—Ü–∏–∏

**–ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞! üéâ**
