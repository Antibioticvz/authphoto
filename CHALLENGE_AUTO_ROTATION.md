# Challenge Auto-Rotation Implementation

## üéØ –¶–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–ª–∞–≤–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–æ—Ç–∞—Ü–∏—é Challenge –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –±–µ–∑ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞.

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. **Preloading —Å–ª–µ–¥—É—é—â–µ–≥–æ Challenge**

- –ó–∞ **10 —Å–µ–∫—É–Ω–¥** –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ Challenge –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π
- Challenge –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `nextChallenge`

### 2. **–ü–ª–∞–≤–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è**

- –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ Challenge –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è** –∑–∞–º–µ–Ω–∞ –Ω–∞ preloaded
- –ù–µ—Ç –≤–∏–¥–∏–º–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
- –°—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ `nextChallenge`

### 3. **Countdown —Ç–∞–π–º–µ—Ä**

- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
- –ú–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç –∑–∞ **5 —Å–µ–∫—É–Ω–¥** –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è

### 4. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ capture –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏**

- –ó–∞ **5 —Å–µ–∫—É–Ω–¥** –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∞ "Capture" –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "Challenge refreshing soon..."
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç —Å—ä–µ–º–∫—É –Ω–∞ –∏—Å—Ç–µ–∫—à–µ–º Challenge

### 5. **–í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è**

- üü¢ **–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** (>5s): –≥–æ–ª—É–±–æ–π —Ñ–æ–Ω, —Å–ø–æ–∫–æ–π–Ω—ã–π countdown
- üü° **Near Expiry** (‚â§5s): –∂–µ–ª—Ç—ã–π —Ñ–æ–Ω, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –∫–Ω–æ–ø–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```
T=0s    Challenge 1 –∑–∞–≥—Ä—É–∂–µ–Ω, TTL=30s
        ‚îú‚îÄ Countdown: 30, 29, 28...

T=20s   Preload Challenge 2 (–≤ —Ñ–æ–Ω–µ)
        ‚îú‚îÄ Countdown: 10, 9, 8...

T=25s   isNearExpiry = true
        ‚îú‚îÄ –ö–Ω–æ–ø–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
        ‚îú‚îÄ Countdown: 5, 4, 3, 2, 1

T=30s   Rotation: Challenge 1 ‚Üí Challenge 2 (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
        ‚îú‚îÄ Preload Challenge 3 (–≤ —Ñ–æ–Ω–µ)
        ‚îú‚îÄ Countdown reset: 30, 29, 28...
        ‚îî‚îÄ –ö–Ω–æ–ø–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Hook: `useChallenge`

**–ù–æ–≤—ã–µ –ø–æ–ª—è:**

```typescript
{
  challenge: ChallengeResponse | null
  timeRemaining: number // –°–µ–∫—É–Ω–¥—ã –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
  isNearExpiry: boolean // true –µ—Å–ª–∏ ‚â§5 —Å–µ–∫—É–Ω–¥
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
}
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ç–∞–π–º–µ—Ä—ã:**

- `preloadTimerRef` - –∑–∞–ø—É—Å–∫–∞–µ—Ç preload –∑–∞ 10s
- `rotationTimerRef` - –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–æ—Ç–∞—Ü–∏—é –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏
- `countdownTimerRef` - –æ–±–Ω–æ–≤–ª—è–µ—Ç countdown –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É

### App.tsx –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **Countdown UI** - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏** - `disabled={... || isNearExpiry}`
3. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ `isNearExpiry`

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ù–µ—Ç –≤–∏–¥–∏–º–æ–π –∑–∞–≥—Ä—É–∑–∫–∏** - Challenge –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ  
‚úÖ **–ù–µ—Ç –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π** - –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞  
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ capture –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏  
‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç countdown  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- **TTL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 30 —Å–µ–∫—É–Ω–¥ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –±—ç–∫–µ–Ω–¥–æ–º)
- **Preload –≤—Ä–µ–º—è**: 10 —Å–µ–∫—É–Ω–¥ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞**: 5 —Å–µ–∫—É–Ω–¥ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- **Fallback**: –µ—Å–ª–∏ preload –Ω–µ —É—Å–ø–µ–ª, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

## üé® UI/UX

### –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

```
‚è∞ Challenge expires in
       25s
```

### Near Expiry

```
‚ö†Ô∏è Challenge expiring soon!
       3s
New challenge will load automatically

[Capture Button - DISABLED]
üîí Capture blocked - Challenge refreshing soon...
```
